---
import Layout from '../../layouts/Layout.astro';
import { getCities, getDealersByCitySlug } from '../../lib/dealers';
import CityCard from '../../components/CityCard.astro';
import cityCovers from '../../data/city-covers.json';

const cities = getCities();
const jsonLd = {
	'@context': 'https://schema.org',
	'@type': 'CollectionPage',
	name: 'Pre-owned Luxury Cars by City (India)',
	description: 'Browse pre-owned luxury car dealers by city across India.',
};

const previews = new Map<string, string | undefined>();
for (const c of cities) {
	const rawCover = (cityCovers as any)?.[c.citySlug] as any;
	const cover = (typeof rawCover === 'string' ? rawCover : rawCover?.url) as string | undefined;
	if (cover) {
		previews.set(c.citySlug, cover);
		continue;
	}
	const d = getDealersByCitySlug(c.citySlug).find((x) => !!x.imageUrl);
	previews.set(c.citySlug, d?.imageUrl);
}
---

<Layout
	title="Pre-owned Luxury Cars by City (India)"
	description="Browse pre-owned luxury car dealers by city across India."
	jsonLd={jsonLd}
>
	<div class="container">
		<header class="hero card">
			<div class="heroText">
				<div class="kicker">Indian Luxury Cars</div>
				<h1>Browse cities</h1>
				<p class="muted">Verified dealers, reviews, locations â€” all in one place.</p>
			</div>
			<div class="heroStats">
				<div class="stat">
					<div class="num">{cities.length}</div>
					<div class="muted small">cities</div>
				</div>
			</div>
		</header>

		<div class="grid">
			{cities.map((c) => (
				<CityCard
					cityName={c.cityName}
					citySlug={c.citySlug}
					count={c.count}
					imageUrl={previews.get(c.citySlug)}
				/>
			))}
		</div>
	</div>

	<style>
		.hero {
			display: flex;
			align-items: flex-start;
			justify-content: space-between;
			gap: 16px;
			margin-bottom: 16px;
			padding: 18px;
			background: radial-gradient(900px 500px at 15% 20%, rgba(99, 102, 241, 0.22), rgba(0, 0, 0, 0)),
				radial-gradient(900px 500px at 85% 30%, rgba(168, 85, 247, 0.18), rgba(0, 0, 0, 0)),
				rgba(255, 255, 255, 0.06);
		}
		.kicker {
			font-size: 12px;
			letter-spacing: 0.08em;
			text-transform: uppercase;
			color: rgba(238, 242, 255, 0.72);
			margin-bottom: 8px;
		}
		h1 {
			margin: 0;
			font-size: 32px;
			letter-spacing: -0.02em;
		}
		.heroStats {
			display: flex;
			gap: 10px;
		}
		.stat {
			padding: 10px 12px;
			border-radius: 14px;
			border: 1px solid rgba(255, 255, 255, 0.12);
			background: rgba(0, 0, 0, 0.18);
			min-width: 92px;
			text-align: center;
		}
		.num {
			font-weight: 850;
			font-size: 22px;
			letter-spacing: -0.02em;
		}
		.grid {
			display: grid;
			grid-template-columns: repeat(1, minmax(0, 1fr));
			gap: 12px;
		}
		@media (min-width: 720px) {
			.grid {
				grid-template-columns: repeat(3, minmax(0, 1fr));
			}
		}
		@media (min-width: 1024px) {
			.grid {
				grid-template-columns: repeat(4, minmax(0, 1fr));
			}
		}
	</style>
</Layout>


