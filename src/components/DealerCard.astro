---
import type { Dealer } from '../lib/dealers';

type Props = {
	dealer: Dealer;
	href: string;
};

const { dealer, href } = Astro.props as Props;
const rating = typeof dealer.totalScore === 'number' ? dealer.totalScore.toFixed(1) : undefined;
---

<a class="group block p-4 rounded-xl bg-white/[0.02] border border-white/5 hover:border-amber-200/30 hover:bg-white/[0.04] transition-all duration-300" href={href}>
	<div class="flex gap-4">
		<div class="w-20 h-20 sm:w-24 sm:h-24 shrink-0 rounded-lg overflow-hidden bg-white/5 relative">
			{dealer.imageUrl ? (
				<img src={dealer.imageUrl} alt="" loading="lazy" decoding="async" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity" />
			) : (
				<div class="w-full h-full flex items-center justify-center text-white/10 text-2xl font-serif">
					{dealer.title.charAt(0)}
				</div>
			)}
		</div>
		
		<div class="flex-1 min-w-0 flex flex-col justify-center">
			<div class="flex justify-between items-start gap-2 mb-1">
				<h3 class="font-serif text-lg text-white/90 truncate group-hover:text-white transition-colors">{dealer.title}</h3>
				{rating && (
					<span class="px-2 py-0.5 rounded text-[10px] font-bold bg-amber-900/20 text-amber-200 border border-amber-900/30">
						{rating} ★
					</span>
				)}
			</div>
			
			<p class="text-sm text-white/50 mb-2 truncate">{dealer.categoryName}</p>
			
			<div class="flex items-center gap-2 text-xs text-white/40">
				<span>{dealer.reviewsCount || 'No'} reviews</span>
				{dealer.neighborhood && (
					<>
						<span>•</span>
						<span class="truncate">{dealer.neighborhood}</span>
					</>
				)}
			</div>
		</div>
	</div>
</a>
